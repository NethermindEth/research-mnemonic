<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mnemonic sharing: main Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="nethermind.png"/></td>
  <td id="projectalign">
   <div id="projectname">Mnemonic sharing<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">Share mnemonics using Shamir Secret Sharing -- a Nethermind project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacemain.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">main Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Contains the create_shares and reconstruct routines, as well as a command-line wrapper.  
<a href="namespacemain.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa0bb9096ba7056a74ab862c96d82f8c5"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemain.html#aa0bb9096ba7056a74ab862c96d82f8c5">create_shares</a> (args)</td></tr>
<tr class="memdesc:aa0bb9096ba7056a74ab862c96d82f8c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take a secret phrase and apply Shamir Secret Sharing to encode it into n secret phrases.  <a href="namespacemain.html#aa0bb9096ba7056a74ab862c96d82f8c5">More...</a><br /></td></tr>
<tr class="separator:aa0bb9096ba7056a74ab862c96d82f8c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67b2fb92125c2f0b661c009a1442c76c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemain.html#a67b2fb92125c2f0b661c009a1442c76c">reconstruct</a> (args)</td></tr>
<tr class="memdesc:a67b2fb92125c2f0b661c009a1442c76c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take JSON shares generated by create_shares.py and reconstruct the original secret phrase.  <a href="namespacemain.html#a67b2fb92125c2f0b661c009a1442c76c">More...</a><br /></td></tr>
<tr class="separator:a67b2fb92125c2f0b661c009a1442c76c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad711b42c226b0c325e3852d01c08260"><td class="memItemLeft" align="right" valign="top"><a id="aad711b42c226b0c325e3852d01c08260" name="aad711b42c226b0c325e3852d01c08260"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>get_reconstruction_data</b> (dict)</td></tr>
<tr class="memdesc:aad711b42c226b0c325e3852d01c08260"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the public reconstruction data from a JSON file, in the format needed by shamir.py. <br /></td></tr>
<tr class="separator:aad711b42c226b0c325e3852d01c08260"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f75dd7c245a03cdad3489d7fa146526"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemain.html#a5f75dd7c245a03cdad3489d7fa146526">get_checksum</a> (entropy, num_entropy_bytes, num_checksum_bits)</td></tr>
<tr class="memdesc:a5f75dd7c245a03cdad3489d7fa146526"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the checksum to be used for a given entropy, as per BIP-39 standards.  <a href="namespacemain.html#a5f75dd7c245a03cdad3489d7fa146526">More...</a><br /></td></tr>
<tr class="separator:a5f75dd7c245a03cdad3489d7fa146526"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af613cea4cba4fb7de8e40896b3368945"><td class="memItemLeft" align="right" valign="top"><a id="af613cea4cba4fb7de8e40896b3368945" name="af613cea4cba4fb7de8e40896b3368945"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>main</b> ()</td></tr>
<tr class="memdesc:af613cea4cba4fb7de8e40896b3368945"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper to execute the create_shares and reconstruct routines from the command line. <br /></td></tr>
<tr class="separator:af613cea4cba4fb7de8e40896b3368945"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Contains the create_shares and reconstruct routines, as well as a command-line wrapper. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aa0bb9096ba7056a74ab862c96d82f8c5" name="aa0bb9096ba7056a74ab862c96d82f8c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0bb9096ba7056a74ab862c96d82f8c5">&#9670;&nbsp;</a></span>create_shares()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def main.create_shares </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take a secret phrase and apply Shamir Secret Sharing to encode it into n secret phrases. </p>
<pre class="fragment">Using Shamir Secret Sharing, a secret phrase with "nw" words can be encoded into n secret phrases,
each with "nw" words as well. Before encoding, a threshold parameter t (with t&lt;=n) is defined, so 
that only t shares are required for the reconstruction of the original secret. (To reconstruct the
secret, use the script reconstruct.py provided in this package.)

The shares generated by this package have the special property of having the ID number (1&lt;=ID&lt;=n)
encoded in the secret phrase itself, so that the user does not need to store it. This is done 
by writing the ID number on the bits that are normally used for the BIP-39 checksum

IMPORTANT: The secret phrase must be BIP-39 compliant! (I.e. the last few bits of the secret must
represent a checksum). See https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki for
more details on BIP-39.


Requisites
----------
1) Before running this script, a dictionary of words to encode secret phrases, with the name
"wordlist.txt", must be provided in the same folder as the script. This dictionary must:
    * Have 2^nb words, where nb is an integer (so that each word represents an nb-bit number)
    * Be a .txt file where each line has a single word.
This package comes pre-loaded with BIP-39's 2048-word dictionary.

2) The secret phrase to be shared should:
    * Have between 12 and 60 words.
    * Have only words that are contained in the dictionary "wordlist.txt".
    * Be written in a single line, with each word separated by only a space.

By default, the secret that will be encoded is read from a .txt file called "secret.txt", to be
located in the same folder as this script. (The secret may also be provided right in the command line
at execution--see below).


Execution and inputs
--------------------
This script should be called from the command line, with the following mandatory inputs (flags):

-n: (integer) Number of shares that will be generated from the secret phrase.
-t, --threshold: (integer) Minimum number of shares that will be required at reconstruction.

The following flags are optional:

-s, --secret: (string) Allows for either of the following options:
    * Specify the secret phrase directly on the command line.
    * Specify a custom file path to a .txt file with the secret.
    (In either case, the secret must abide by the same format considerations stated above)
-v, --verbose: If this flag is used, the generated shares are verbose (see "outputs" below.)


Outputs
-------
During execution, the /shares folder is emptied, and its contents are replaced with the following 
JSON files:

* reconstruction_data.json: Contains the following entries:
    - total_shares: Number of shares n generated during encoding
    - threshold: Threshold t representing the minimum number of shares needed for reconstruction.
    - primitive_poly: Primitive polynomial used to generate the Galois field used for encryption;
    necessary for decryption. For more details, please read modules/shamir.py
    - dictionary: A copy of the contents of the dictionary wordlist.txt

* share_i.json (for 1&lt;=i&lt;=n): Contains the following entry:
    - share: list of words, one of the n secret phrases that the original secret was encoded into.
    Remark: if the --verbose flag was used at runtime, each of the JSON shares will also contain the
    reconstruction data.

The shares are also printed on the command line.
</pre> 
</div>
</div>
<a id="a67b2fb92125c2f0b661c009a1442c76c" name="a67b2fb92125c2f0b661c009a1442c76c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67b2fb92125c2f0b661c009a1442c76c">&#9670;&nbsp;</a></span>reconstruct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def main.reconstruct </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take JSON shares generated by create_shares.py and reconstruct the original secret phrase. </p>
<pre class="fragment">Requisites 
----------
(To read about the format needed by the following files, read the documentation in create_shares.py)

1) At least t JSON shares, in the format generated by create_shares.py, must be present in the
folder /shares. Here, t represents the threshold used when creating the shares

2) Unless the JSON shares are verbose, the file reconstruction_data.json, containing the public 
reconstruction data, should also be present in the folder. This file is not needed if the shares are
verbose, in which case one can run this script with the -v flag.


Execution and inputs
--------------------
This script should be called from the command line. It has only one optional flag

-v, --verbose: If this flag is used, the public reconstruction data is taken directly from the JSON
shares. The script verifies the consistency of this data among all the shares, throwing an exception
if this data is not consistent.


Outputs
-------
The file secret_reconstructed.txt is generated in the script's folder. The reconstructed secret is
also printed on the command line.
</pre> 
</div>
</div>
<a id="a5f75dd7c245a03cdad3489d7fa146526" name="a5f75dd7c245a03cdad3489d7fa146526"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f75dd7c245a03cdad3489d7fa146526">&#9670;&nbsp;</a></span>get_checksum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def main.get_checksum </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>entropy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_entropy_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_checksum_bits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the checksum to be used for a given entropy, as per BIP-39 standards. </p>
<pre class="fragment">Here, the entropy is inputted as an integer value (not as bits). This is why we need to add the
number of total bytes to convert the entropy to. 
</pre> 
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemain.html">main</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
